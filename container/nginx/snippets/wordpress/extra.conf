# --- SECURITY ADDITIONS ---

# 1. Block XML-RPC (Major attack vector for WordPress)
location = /xmlrpc.php {
    deny all;
    access_log off;
    log_not_found off;
}

# 2. Block access to sensitive system/git files
# (Added .env, .log, .sh, .bak, .sql to your existing list)
location ~* \.(htaccess|htpasswd|git|env|log|ini|sh|bak|sql)$ {
    deny all;
}

# 3. Block User Enumeration (Stops bots from guessing usernames)
if ($args ~* "author=[0-9]") {
    return 403;
}

location ~* \.(js|css|png|jpg|jpeg|gif|ico|webp|svg|woff|woff2|eot|ttf)$ {
    expires max;
    log_not_found off;
}

location ~ /\.ht {
    deny all;
}

location ~ ^/\.user\.ini {
    deny all;
}

location = /favicon.ico { access_log off; log_not_found off; }
location = /robots.txt  { access_log off; log_not_found off; }
